# 第24章 网络请求与远程资源
Ajax技术涉及发送服务器请求额外数据而不刷新页面，从而实现良好的用户体验。把Ajax技术推到历史舞台的关键技术是XMLHttpRequest(XHR)对象。这个技术主要是可以实现在不刷新页面的情况下从服务器获取数据，格式并不一定是XML。  
XHR对象的API被普遍认为比较难用，而Fetch API自从诞生以来就迅速成为了XHR更现代的替代标准。Fetch API支持promise和service worker，已经成为极其强大的Web开发工具。  
## 24.1 XMLHttpRequest对象
所有现代浏览器都通过XMLHttpRequest构造函数原生支持XHR对象。
```
let xhr = new XMLHttpRequest();
```
使用XHR对象首先要调用open()方法，这个方法接收3个参数：请求类型（"get"、"post"等）、请求URL，以及表示请求是否异步的布尔值（true表示异步，false表示同步）。  
同步和异步的区别是：如果是同步的，之后的JavaScript代码会等待服务器响应之后再继续执行；如果是异步的，之后的JavaScript代码可以先执行而不用一直等待服务器响应数据。  
这行代码向example.php发送了一个同步的GET请求，这里的URL是相对于当前代码所在页面的，也可以使用绝对URL。  
调用open()不会实际发送请求，只是为发送请求做好准备。
```
xhr.open("get","example.php",false);
```
要发送定义好的请求，必须调用send()方法，send()方法接收一个参数，是作为请求体发送的数据。如果不需要发送请求体，则必须传null，因为这个参数在某些浏览器中是必需的。调用send()之后，请求就会发送到服务器。
```
xhr.send(null);
```
收到响应后，XHR对象的以下属性会被填充上数据：
- responseText：作为响应体返回的文本。
- responseXML：如果响应的内容类型是“text/xml”或“application/xml”，那就是包含响应数据的XML DOM 文档。
- status：响应的HTTP状态。
- statusText：响应的HTTP状态描述。  

收到响应后，第一步要检查status属性以确保响应成功返回。一般来说，HTTP状态码为2xx表示成功。此时，responseText或responseXML属性中会有内容。如果HTTP状态码是304，则表示资源未修改过，是从浏览器缓存中直接拿取的。这也意味着响应有效。
```
if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {
    console.log(xhr.responseText);
} else {
    console.log(`Request was unsuccessful: ${xhr.status}`);
}
```
为确定下一步该执行什么操作，最好检查status而不是statusText属性，因为后者已经被证实在跨浏览器的情况下不可靠。无论是什么响应内容类型，responseText属性时钟会保存响应体，而responseXML则对非XML数据是null。  
XHR对象有一个
